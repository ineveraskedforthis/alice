#pragma once

#include "system_state.hpp"
#include <cstdint>

namespace ogl {

// borrowed from http://www.burtleburtle.net/bob/hash/doobs.html
inline constexpr uint32_t color_from_hash(uint32_t color) {
	uint32_t m1 = 0x1337CAFE;
	uint32_t m2 = 0xDEADBEEF;
	m1 -= m2;
	m1 -= color;
	m1 ^= (color >> 13);
	m2 -= color;
	m2 -= m1;
	m2 ^= (m1 << 8);
	color -= m1;
	color -= m2;
	color ^= (m2 >> 13);
	m1 -= m2;
	m1 -= color;
	m1 ^= (color >> 12);
	m2 -= color;
	m2 -= m1;
	m2 ^= (m1 << 16);
	color -= m1;
	color -= m2;
	color ^= (m2 >> 5);
	m1 -= m2;
	m1 -= color;
	m1 ^= (color >> 3);
	m2 -= color;
	m2 -= m1;
	m2 ^= (m1 << 10);
	color -= m1;
	color -= m2;
	color ^= (m2 >> 15);
	return color;
}

// https://github.com/BIDS/colormap/blob/master/colormaps.py
// CC0 licensed

constexpr float magma[256][3] = { { 0.001462f, 0.000466f, 0.013866f },
			{0.002258f, 0.001295f, 0.018331f},
			{0.003279f, 0.002305f, 0.023708f},
			{0.004512f, 0.003490f, 0.029965f},
			{0.005950f, 0.004843f, 0.037130f},
			{0.007588f, 0.006356f, 0.044973f},
			{0.009426f, 0.008022f, 0.052844f},
			{0.011465f, 0.009828f, 0.060750f},
			{0.013708f, 0.011771f, 0.068667f},
			{0.016156f, 0.013840f, 0.076603f},
			{0.018815f, 0.016026f, 0.084584f},
			{0.021692f, 0.018320f, 0.092610f},
			{0.024792f, 0.020715f, 0.100676f},
			{0.028123f, 0.023201f, 0.108787f},
			{0.031696f, 0.025765f, 0.116965f},
			{0.035520f, 0.028397f, 0.125209f},
			{0.039608f, 0.031090f, 0.133515f},
			{0.043830f, 0.033830f, 0.141886f},
			{0.048062f, 0.036607f, 0.150327f},
			{0.052320f, 0.039407f, 0.158841f},
			{0.056615f, 0.042160f, 0.167446f},
			{0.060949f, 0.044794f, 0.176129f},
			{0.065330f, 0.047318f, 0.184892f},
			{0.069764f, 0.049726f, 0.193735f},
			{0.074257f, 0.052017f, 0.202660f},
			{0.078815f, 0.054184f, 0.211667f},
			{0.083446f, 0.056225f, 0.220755f},
			{0.088155f, 0.058133f, 0.229922f},
			{0.092949f, 0.059904f, 0.239164f},
			{0.097833f, 0.061531f, 0.248477f},
			{0.102815f, 0.063010f, 0.257854f},
			{0.107899f, 0.064335f, 0.267289f},
			{0.113094f, 0.065492f, 0.276784f},
			{0.118405f, 0.066479f, 0.286321f},
			{0.123833f, 0.067295f, 0.295879f},
			{0.129380f, 0.067935f, 0.305443f},
			{0.135053f, 0.068391f, 0.315000f},
			{0.140858f, 0.068654f, 0.324538f},
			{0.146785f, 0.068738f, 0.334011f},
			{0.152839f, 0.068637f, 0.343404f},
			{0.159018f, 0.068354f, 0.352688f},
			{0.165308f, 0.067911f, 0.361816f},
			{0.171713f, 0.067305f, 0.370771f},
			{0.178212f, 0.066576f, 0.379497f},
			{0.184801f, 0.065732f, 0.387973f},
			{0.191460f, 0.064818f, 0.396152f},
			{0.198177f, 0.063862f, 0.404009f},
			{0.204935f, 0.062907f, 0.411514f},
			{0.211718f, 0.061992f, 0.418647f},
			{0.218512f, 0.061158f, 0.425392f},
			{0.225302f, 0.060445f, 0.431742f},
			{0.232077f, 0.059889f, 0.437695f},
			{0.238826f, 0.059517f, 0.443256f},
			{0.245543f, 0.059352f, 0.448436f},
			{0.252220f, 0.059415f, 0.453248f},
			{0.258857f, 0.059706f, 0.457710f},
			{0.265447f, 0.060237f, 0.461840f},
			{0.271994f, 0.060994f, 0.465660f},
			{0.278493f, 0.061978f, 0.469190f},
			{0.284951f, 0.063168f, 0.472451f},
			{0.291366f, 0.064553f, 0.475462f},
			{0.297740f, 0.066117f, 0.478243f},
			{0.304081f, 0.067835f, 0.480812f},
			{0.310382f, 0.069702f, 0.483186f},
			{0.316654f, 0.071690f, 0.485380f},
			{0.322899f, 0.073782f, 0.487408f},
			{0.329114f, 0.075972f, 0.489287f},
			{0.335308f, 0.078236f, 0.491024f},
			{0.341482f, 0.080564f, 0.492631f},
			{0.347636f, 0.082946f, 0.494121f},
			{0.353773f, 0.085373f, 0.495501f},
			{0.359898f, 0.087831f, 0.496778f},
			{0.366012f, 0.090314f, 0.497960f},
			{0.372116f, 0.092816f, 0.499053f},
			{0.378211f, 0.095332f, 0.500067f},
			{0.384299f, 0.097855f, 0.501002f},
			{0.390384f, 0.100379f, 0.501864f},
			{0.396467f, 0.102902f, 0.502658f},
			{0.402548f, 0.105420f, 0.503386f},
			{0.408629f, 0.107930f, 0.504052f},
			{0.414709f, 0.110431f, 0.504662f},
			{0.420791f, 0.112920f, 0.505215f},
			{0.426877f, 0.115395f, 0.505714f},
			{0.432967f, 0.117855f, 0.506160f},
			{0.439062f, 0.120298f, 0.506555f},
			{0.445163f, 0.122724f, 0.506901f},
			{0.451271f, 0.125132f, 0.507198f},
			{0.457386f, 0.127522f, 0.507448f},
			{0.463508f, 0.129893f, 0.507652f},
			{0.469640f, 0.132245f, 0.507809f},
			{0.475780f, 0.134577f, 0.507921f},
			{0.481929f, 0.136891f, 0.507989f},
			{0.488088f, 0.139186f, 0.508011f},
			{0.494258f, 0.141462f, 0.507988f},
			{0.500438f, 0.143719f, 0.507920f},
			{0.506629f, 0.145958f, 0.507806f},
			{0.512831f, 0.148179f, 0.507648f},
			{0.519045f, 0.150383f, 0.507443f},
			{0.525270f, 0.152569f, 0.507192f},
			{0.531507f, 0.154739f, 0.506895f},
			{0.537755f, 0.156894f, 0.506551f},
			{0.544015f, 0.159033f, 0.506159f},
			{0.550287f, 0.161158f, 0.505719f},
			{0.556571f, 0.163269f, 0.505230f},
			{0.562866f, 0.165368f, 0.504692f},
			{0.569172f, 0.167454f, 0.504105f},
			{0.575490f, 0.169530f, 0.503466f},
			{0.581819f, 0.171596f, 0.502777f},
			{0.588158f, 0.173652f, 0.502035f},
			{0.594508f, 0.175701f, 0.501241f},
			{0.600868f, 0.177743f, 0.500394f},
			{0.607238f, 0.179779f, 0.499492f},
			{0.613617f, 0.181811f, 0.498536f},
			{0.620005f, 0.183840f, 0.497524f},
			{0.626401f, 0.185867f, 0.496456f},
			{0.632805f, 0.187893f, 0.495332f},
			{0.639216f, 0.189921f, 0.494150f},
			{0.645633f, 0.191952f, 0.492910f},
			{0.652056f, 0.193986f, 0.491611f},
			{0.658483f, 0.196027f, 0.490253f},
			{0.664915f, 0.198075f, 0.488836f},
			{0.671349f, 0.200133f, 0.487358f},
			{0.677786f, 0.202203f, 0.485819f},
			{0.684224f, 0.204286f, 0.484219f},
			{0.690661f, 0.206384f, 0.482558f},
			{0.697098f, 0.208501f, 0.480835f},
			{0.703532f, 0.210638f, 0.479049f},
			{0.709962f, 0.212797f, 0.477201f},
			{0.716387f, 0.214982f, 0.475290f},
			{0.722805f, 0.217194f, 0.473316f},
			{0.729216f, 0.219437f, 0.471279f},
			{0.735616f, 0.221713f, 0.469180f},
			{0.742004f, 0.224025f, 0.467018f},
			{0.748378f, 0.226377f, 0.464794f},
			{0.754737f, 0.228772f, 0.462509f},
			{0.761077f, 0.231214f, 0.460162f},
			{0.767398f, 0.233705f, 0.457755f},
			{0.773695f, 0.236249f, 0.455289f},
			{0.779968f, 0.238851f, 0.452765f},
			{0.786212f, 0.241514f, 0.450184f},
			{0.792427f, 0.244242f, 0.447543f},
			{0.798608f, 0.247040f, 0.444848f},
			{0.804752f, 0.249911f, 0.442102f},
			{0.810855f, 0.252861f, 0.439305f},
			{0.816914f, 0.255895f, 0.436461f},
			{0.822926f, 0.259016f, 0.433573f},
			{0.828886f, 0.262229f, 0.430644f},
			{0.834791f, 0.265540f, 0.427671f},
			{0.840636f, 0.268953f, 0.424666f},
			{0.846416f, 0.272473f, 0.421631f},
			{0.852126f, 0.276106f, 0.418573f},
			{0.857763f, 0.279857f, 0.415496f},
			{0.863320f, 0.283729f, 0.412403f},
			{0.868793f, 0.287728f, 0.409303f},
			{0.874176f, 0.291859f, 0.406205f},
			{0.879464f, 0.296125f, 0.403118f},
			{0.884651f, 0.300530f, 0.400047f},
			{0.889731f, 0.305079f, 0.397002f},
			{0.894700f, 0.309773f, 0.393995f},
			{0.899552f, 0.314616f, 0.391037f},
			{0.904281f, 0.319610f, 0.388137f},
			{0.908884f, 0.324755f, 0.385308f},
			{0.913354f, 0.330052f, 0.382563f},
			{0.917689f, 0.335500f, 0.379915f},
			{0.921884f, 0.341098f, 0.377376f},
			{0.925937f, 0.346844f, 0.374959f},
			{0.929845f, 0.352734f, 0.372677f},
			{0.933606f, 0.358764f, 0.370541f},
			{0.937221f, 0.364929f, 0.368567f},
			{0.940687f, 0.371224f, 0.366762f},
			{0.944006f, 0.377643f, 0.365136f},
			{0.947180f, 0.384178f, 0.363701f},
			{0.950210f, 0.390820f, 0.362468f},
			{0.953099f, 0.397563f, 0.361438f},
			{0.955849f, 0.404400f, 0.360619f},
			{0.958464f, 0.411324f, 0.360014f},
			{0.960949f, 0.418323f, 0.359630f},
			{0.963310f, 0.425390f, 0.359469f},
			{0.965549f, 0.432519f, 0.359529f},
			{0.967671f, 0.439703f, 0.359810f},
			{0.969680f, 0.446936f, 0.360311f},
			{0.971582f, 0.454210f, 0.361030f},
			{0.973381f, 0.461520f, 0.361965f},
			{0.975082f, 0.468861f, 0.363111f},
			{0.976690f, 0.476226f, 0.364466f},
			{0.978210f, 0.483612f, 0.366025f},
			{0.979645f, 0.491014f, 0.367783f},
			{0.981000f, 0.498428f, 0.369734f},
			{0.982279f, 0.505851f, 0.371874f},
			{0.983485f, 0.513280f, 0.374198f},
			{0.984622f, 0.520713f, 0.376698f},
			{0.985693f, 0.528148f, 0.379371f},
			{0.986700f, 0.535582f, 0.382210f},
			{0.987646f, 0.543015f, 0.385210f},
			{0.988533f, 0.550446f, 0.388365f},
			{0.989363f, 0.557873f, 0.391671f},
			{0.990138f, 0.565296f, 0.395122f},
			{0.990871f, 0.572706f, 0.398714f},
			{0.991558f, 0.580107f, 0.402441f},
			{0.992196f, 0.587502f, 0.406299f},
			{0.992785f, 0.594891f, 0.410283f},
			{0.993326f, 0.602275f, 0.414390f},
			{0.993834f, 0.609644f, 0.418613f},
			{0.994309f, 0.616999f, 0.422950f},
			{0.994738f, 0.624350f, 0.427397f},
			{0.995122f, 0.631696f, 0.431951f},
			{0.995480f, 0.639027f, 0.436607f},
			{0.995810f, 0.646344f, 0.441361f},
			{0.996096f, 0.653659f, 0.446213f},
			{0.996341f, 0.660969f, 0.451160f},
			{0.996580f, 0.668256f, 0.456192f},
			{0.996775f, 0.675541f, 0.461314f},
			{0.996925f, 0.682828f, 0.466526f},
			{0.997077f, 0.690088f, 0.471811f},
			{0.997186f, 0.697349f, 0.477182f},
			{0.997254f, 0.704611f, 0.482635f},
			{0.997325f, 0.711848f, 0.488154f},
			{0.997351f, 0.719089f, 0.493755f},
			{0.997351f, 0.726324f, 0.499428f},
			{0.997341f, 0.733545f, 0.505167f},
			{0.997285f, 0.740772f, 0.510983f},
			{0.997228f, 0.747981f, 0.516859f},
			{0.997138f, 0.755190f, 0.522806f},
			{0.997019f, 0.762398f, 0.528821f},
			{0.996898f, 0.769591f, 0.534892f},
			{0.996727f, 0.776795f, 0.541039f},
			{0.996571f, 0.783977f, 0.547233f},
			{0.996369f, 0.791167f, 0.553499f},
			{0.996162f, 0.798348f, 0.559820f},
			{0.995932f, 0.805527f, 0.566202f},
			{0.995680f, 0.812706f, 0.572645f},
			{0.995424f, 0.819875f, 0.579140f},
			{0.995131f, 0.827052f, 0.585701f},
			{0.994851f, 0.834213f, 0.592307f},
			{0.994524f, 0.841387f, 0.598983f},
			{0.994222f, 0.848540f, 0.605696f},
			{0.993866f, 0.855711f, 0.612482f},
			{0.993545f, 0.862859f, 0.619299f},
			{0.993170f, 0.870024f, 0.626189f},
			{0.992831f, 0.877168f, 0.633109f},
			{0.992440f, 0.884330f, 0.640099f},
			{0.992089f, 0.891470f, 0.647116f},
			{0.991688f, 0.898627f, 0.654202f},
			{0.991332f, 0.905763f, 0.661309f},
			{0.990930f, 0.912915f, 0.668481f},
			{0.990570f, 0.920049f, 0.675675f},
			{0.990175f, 0.927196f, 0.682926f},
			{0.989815f, 0.934329f, 0.690198f},
			{0.989434f, 0.941470f, 0.697519f},
			{0.989077f, 0.948604f, 0.704863f},
			{0.988717f, 0.955742f, 0.712242f},
			{0.988367f, 0.962878f, 0.719649f},
			{0.988033f, 0.970012f, 0.727077f},
			{0.987691f, 0.977154f, 0.734536f},
			{0.987387f, 0.984288f, 0.742002f},
			{ 0.987053f, 0.991438f, 0.749504f } };

constexpr double viridis[256][3] =
			{ {0.267004, 0.004874, 0.329415},
			{0.268510, 0.009605, 0.335427},
			{0.269944, 0.014625, 0.341379},
			{0.271305, 0.019942, 0.347269},
			{0.272594, 0.025563, 0.353093},
			{0.273809, 0.031497, 0.358853},
			{0.274952, 0.037752, 0.364543},
			{0.276022, 0.044167, 0.370164},
			{0.277018, 0.050344, 0.375715},
			{0.277941, 0.056324, 0.381191},
			{0.278791, 0.062145, 0.386592},
			{0.279566, 0.067836, 0.391917},
			{0.280267, 0.073417, 0.397163},
			{0.280894, 0.078907, 0.402329},
			{0.281446, 0.084320, 0.407414},
			{0.281924, 0.089666, 0.412415},
			{0.282327, 0.094955, 0.417331},
			{0.282656, 0.100196, 0.422160},
			{0.282910, 0.105393, 0.426902},
			{0.283091, 0.110553, 0.431554},
			{0.283197, 0.115680, 0.436115},
			{0.283229, 0.120777, 0.440584},
			{0.283187, 0.125848, 0.444960},
			{0.283072, 0.130895, 0.449241},
			{0.282884, 0.135920, 0.453427},
			{0.282623, 0.140926, 0.457517},
			{0.282290, 0.145912, 0.461510},
			{0.281887, 0.150881, 0.465405},
			{0.281412, 0.155834, 0.469201},
			{0.280868, 0.160771, 0.472899},
			{0.280255, 0.165693, 0.476498},
			{0.279574, 0.170599, 0.479997},
			{0.278826, 0.175490, 0.483397},
			{0.278012, 0.180367, 0.486697},
			{0.277134, 0.185228, 0.489898},
			{0.276194, 0.190074, 0.493001},
			{0.275191, 0.194905, 0.496005},
			{0.274128, 0.199721, 0.498911},
			{0.273006, 0.204520, 0.501721},
			{0.271828, 0.209303, 0.504434},
			{0.270595, 0.214069, 0.507052},
			{0.269308, 0.218818, 0.509577},
			{0.267968, 0.223549, 0.512008},
			{0.266580, 0.228262, 0.514349},
			{0.265145, 0.232956, 0.516599},
			{0.263663, 0.237631, 0.518762},
			{0.262138, 0.242286, 0.520837},
			{0.260571, 0.246922, 0.522828},
			{0.258965, 0.251537, 0.524736},
			{0.257322, 0.256130, 0.526563},
			{0.255645, 0.260703, 0.528312},
			{0.253935, 0.265254, 0.529983},
			{0.252194, 0.269783, 0.531579},
			{0.250425, 0.274290, 0.533103},
			{0.248629, 0.278775, 0.534556},
			{0.246811, 0.283237, 0.535941},
			{0.244972, 0.287675, 0.537260},
			{0.243113, 0.292092, 0.538516},
			{0.241237, 0.296485, 0.539709},
			{0.239346, 0.300855, 0.540844},
			{0.237441, 0.305202, 0.541921},
			{0.235526, 0.309527, 0.542944},
			{0.233603, 0.313828, 0.543914},
			{0.231674, 0.318106, 0.544834},
			{0.229739, 0.322361, 0.545706},
			{0.227802, 0.326594, 0.546532},
			{0.225863, 0.330805, 0.547314},
			{0.223925, 0.334994, 0.548053},
			{0.221989, 0.339161, 0.548752},
			{0.220057, 0.343307, 0.549413},
			{0.218130, 0.347432, 0.550038},
			{0.216210, 0.351535, 0.550627},
			{0.214298, 0.355619, 0.551184},
			{0.212395, 0.359683, 0.551710},
			{0.210503, 0.363727, 0.552206},
			{0.208623, 0.367752, 0.552675},
			{0.206756, 0.371758, 0.553117},
			{0.204903, 0.375746, 0.553533},
			{0.203063, 0.379716, 0.553925},
			{0.201239, 0.383670, 0.554294},
			{0.199430, 0.387607, 0.554642},
			{0.197636, 0.391528, 0.554969},
			{0.195860, 0.395433, 0.555276},
			{0.194100, 0.399323, 0.555565},
			{0.192357, 0.403199, 0.555836},
			{0.190631, 0.407061, 0.556089},
			{0.188923, 0.410910, 0.556326},
			{0.187231, 0.414746, 0.556547},
			{0.185556, 0.418570, 0.556753},
			{0.183898, 0.422383, 0.556944},
			{0.182256, 0.426184, 0.557120},
			{0.180629, 0.429975, 0.557282},
			{0.179019, 0.433756, 0.557430},
			{0.177423, 0.437527, 0.557565},
			{0.175841, 0.441290, 0.557685},
			{0.174274, 0.445044, 0.557792},
			{0.172719, 0.448791, 0.557885},
			{0.171176, 0.452530, 0.557965},
			{0.169646, 0.456262, 0.558030},
			{0.168126, 0.459988, 0.558082},
			{0.166617, 0.463708, 0.558119},
			{0.165117, 0.467423, 0.558141},
			{0.163625, 0.471133, 0.558148},
			{0.162142, 0.474838, 0.558140},
			{0.160665, 0.478540, 0.558115},
			{0.159194, 0.482237, 0.558073},
			{0.157729, 0.485932, 0.558013},
			{0.156270, 0.489624, 0.557936},
			{0.154815, 0.493313, 0.557840},
			{0.153364, 0.497000, 0.557724},
			{0.151918, 0.500685, 0.557587},
			{0.150476, 0.504369, 0.557430},
			{0.149039, 0.508051, 0.557250},
			{0.147607, 0.511733, 0.557049},
			{0.146180, 0.515413, 0.556823},
			{0.144759, 0.519093, 0.556572},
			{0.143343, 0.522773, 0.556295},
			{0.141935, 0.526453, 0.555991},
			{0.140536, 0.530132, 0.555659},
			{0.139147, 0.533812, 0.555298},
			{0.137770, 0.537492, 0.554906},
			{0.136408, 0.541173, 0.554483},
			{0.135066, 0.544853, 0.554029},
			{0.133743, 0.548535, 0.553541},
			{0.132444, 0.552216, 0.553018},
			{0.131172, 0.555899, 0.552459},
			{0.129933, 0.559582, 0.551864},
			{0.128729, 0.563265, 0.551229},
			{0.127568, 0.566949, 0.550556},
			{0.126453, 0.570633, 0.549841},
			{0.125394, 0.574318, 0.549086},
			{0.124395, 0.578002, 0.548287},
			{0.123463, 0.581687, 0.547445},
			{0.122606, 0.585371, 0.546557},
			{0.121831, 0.589055, 0.545623},
			{0.121148, 0.592739, 0.544641},
			{0.120565, 0.596422, 0.543611},
			{0.120092, 0.600104, 0.542530},
			{0.119738, 0.603785, 0.541400},
			{0.119512, 0.607464, 0.540218},
			{0.119423, 0.611141, 0.538982},
			{0.119483, 0.614817, 0.537692},
			{0.119699, 0.618490, 0.536347},
			{0.120081, 0.622161, 0.534946},
			{0.120638, 0.625828, 0.533488},
			{0.121380, 0.629492, 0.531973},
			{0.122312, 0.633153, 0.530398},
			{0.123444, 0.636809, 0.528763},
			{0.124780, 0.640461, 0.527068},
			{0.126326, 0.644107, 0.525311},
			{0.128087, 0.647749, 0.523491},
			{0.130067, 0.651384, 0.521608},
			{0.132268, 0.655014, 0.519661},
			{0.134692, 0.658636, 0.517649},
			{0.137339, 0.662252, 0.515571},
			{0.140210, 0.665859, 0.513427},
			{0.143303, 0.669459, 0.511215},
			{0.146616, 0.673050, 0.508936},
			{0.150148, 0.676631, 0.506589},
			{0.153894, 0.680203, 0.504172},
			{0.157851, 0.683765, 0.501686},
			{0.162016, 0.687316, 0.499129},
			{0.166383, 0.690856, 0.496502},
			{0.170948, 0.694384, 0.493803},
			{0.175707, 0.697900, 0.491033},
			{0.180653, 0.701402, 0.488189},
			{0.185783, 0.704891, 0.485273},
			{0.191090, 0.708366, 0.482284},
			{0.196571, 0.711827, 0.479221},
			{0.202219, 0.715272, 0.476084},
			{0.208030, 0.718701, 0.472873},
			{0.214000, 0.722114, 0.469588},
			{0.220124, 0.725509, 0.466226},
			{0.226397, 0.728888, 0.462789},
			{0.232815, 0.732247, 0.459277},
			{0.239374, 0.735588, 0.455688},
			{0.246070, 0.738910, 0.452024},
			{0.252899, 0.742211, 0.448284},
			{0.259857, 0.745492, 0.444467},
			{0.266941, 0.748751, 0.440573},
			{0.274149, 0.751988, 0.436601},
			{0.281477, 0.755203, 0.432552},
			{0.288921, 0.758394, 0.428426},
			{0.296479, 0.761561, 0.424223},
			{0.304148, 0.764704, 0.419943},
			{0.311925, 0.767822, 0.415586},
			{0.319809, 0.770914, 0.411152},
			{0.327796, 0.773980, 0.406640},
			{0.335885, 0.777018, 0.402049},
			{0.344074, 0.780029, 0.397381},
			{0.352360, 0.783011, 0.392636},
			{0.360741, 0.785964, 0.387814},
			{0.369214, 0.788888, 0.382914},
			{0.377779, 0.791781, 0.377939},
			{0.386433, 0.794644, 0.372886},
			{0.395174, 0.797475, 0.367757},
			{0.404001, 0.800275, 0.362552},
			{0.412913, 0.803041, 0.357269},
			{0.421908, 0.805774, 0.351910},
			{0.430983, 0.808473, 0.346476},
			{0.440137, 0.811138, 0.340967},
			{0.449368, 0.813768, 0.335384},
			{0.458674, 0.816363, 0.329727},
			{0.468053, 0.818921, 0.323998},
			{0.477504, 0.821444, 0.318195},
			{0.487026, 0.823929, 0.312321},
			{0.496615, 0.826376, 0.306377},
			{0.506271, 0.828786, 0.300362},
			{0.515992, 0.831158, 0.294279},
			{0.525776, 0.833491, 0.288127},
			{0.535621, 0.835785, 0.281908},
			{0.545524, 0.838039, 0.275626},
			{0.555484, 0.840254, 0.269281},
			{0.565498, 0.842430, 0.262877},
			{0.575563, 0.844566, 0.256415},
			{0.585678, 0.846661, 0.249897},
			{0.595839, 0.848717, 0.243329},
			{0.606045, 0.850733, 0.236712},
			{0.616293, 0.852709, 0.230052},
			{0.626579, 0.854645, 0.223353},
			{0.636902, 0.856542, 0.216620},
			{0.647257, 0.858400, 0.209861},
			{0.657642, 0.860219, 0.203082},
			{0.668054, 0.861999, 0.196293},
			{0.678489, 0.863742, 0.189503},
			{0.688944, 0.865448, 0.182725},
			{0.699415, 0.867117, 0.175971},
			{0.709898, 0.868751, 0.169257},
			{0.720391, 0.870350, 0.162603},
			{0.730889, 0.871916, 0.156029},
			{0.741388, 0.873449, 0.149561},
			{0.751884, 0.874951, 0.143228},
			{0.762373, 0.876424, 0.137064},
			{0.772852, 0.877868, 0.131109},
			{0.783315, 0.879285, 0.125405},
			{0.793760, 0.880678, 0.120005},
			{0.804182, 0.882046, 0.114965},
			{0.814576, 0.883393, 0.110347},
			{0.824940, 0.884720, 0.106217},
			{0.835270, 0.886029, 0.102646},
			{0.845561, 0.887322, 0.099702},
			{0.855810, 0.888601, 0.097452},
			{0.866013, 0.889868, 0.095953},
			{0.876168, 0.891125, 0.095250},
			{0.886271, 0.892374, 0.095374},
			{0.896320, 0.893616, 0.096335},
			{0.906311, 0.894855, 0.098125},
			{0.916242, 0.896091, 0.100717},
			{0.926106, 0.897330, 0.104071},
			{0.935904, 0.898570, 0.108131},
			{0.945636, 0.899815, 0.112838},
			{0.955300, 0.901065, 0.118128},
			{0.964894, 0.902323, 0.123941},
			{0.974417, 0.903590, 0.130215},
			{0.983868, 0.904867, 0.136897},
			{0.993248, 0.906157, 0.143936}
};

/*
The Scientific colour maps are licensed under a MIT License
Copyright(c) 2023, Fabio Crameri
Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation
files(the ”Software”), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify,
merge, publish, distribute, sublicense, and /or sell copies of the
Software, and to permit persons to whom the Software is furnished
to do so, subject to the following conditions :
The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED ”AS IS”, WITHOUT WARRANTY OF
ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED
TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT
SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT
OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/

const double berlin[256][3] = {
	{ 0.621082, 0.690182, 0.999507 },
	{ 0.612157, 0.689228, 0.995374 },
	{ 0.603202, 0.688250, 0.991239 },
	{ 0.594200, 0.687257, 0.987092 },
	{ 0.585165, 0.686248, 0.982922 },
	{ 0.576088, 0.685222, 0.978733 },
	{ 0.566961, 0.684166, 0.974524 },
	{ 0.557791, 0.683098, 0.970288 },
	{ 0.548590, 0.681992, 0.966016 },
	{ 0.539327, 0.680859, 0.961704 },
	{ 0.530034, 0.679691, 0.957350 },
	{ 0.520687, 0.678484, 0.952942 },
	{ 0.511295, 0.677230, 0.948466 },
	{ 0.501863, 0.675908, 0.943923 },
	{ 0.492368, 0.674526, 0.939297 },
	{ 0.482832, 0.673075, 0.934574 },
	{ 0.473239, 0.671530, 0.929751 },
	{ 0.463610, 0.669898, 0.924806 },
	{ 0.453931, 0.668152, 0.919735 },
	{ 0.444213, 0.666275, 0.914518 },
	{ 0.434440, 0.664271, 0.909136 },
	{ 0.424645, 0.662120, 0.903586 },
	{ 0.414818, 0.659791, 0.897845 },
	{ 0.404975, 0.657289, 0.891905 },
	{ 0.395137, 0.654579, 0.885750 },
	{ 0.385296, 0.651674, 0.879368 },
	{ 0.375493, 0.648536, 0.872757 },
	{ 0.365742, 0.645164, 0.865903 },
	{ 0.356059, 0.641552, 0.858801 },
	{ 0.346453, 0.637692, 0.851451 },
	{ 0.336982, 0.633574, 0.843855 },
	{ 0.327642, 0.629189, 0.836017 },
	{ 0.318487, 0.624551, 0.827937 },
	{ 0.309539, 0.619657, 0.819628 },
	{ 0.300784, 0.614497, 0.811108 },
	{ 0.292309, 0.609115, 0.802379 },
	{ 0.284098, 0.603485, 0.793470 },
	{ 0.276205, 0.597634, 0.784386 },
	{ 0.268595, 0.591580, 0.775143 },
	{ 0.261308, 0.585335, 0.765780 },
	{ 0.254368, 0.578908, 0.756296 },
	{ 0.247753, 0.572328, 0.746719 },
	{ 0.241464, 0.565596, 0.737066 },
	{ 0.235515, 0.558748, 0.727351 },
	{ 0.229842, 0.551802, 0.717600 },
	{ 0.224503, 0.544750, 0.707805 },
	{ 0.219485, 0.537628, 0.697998 },
	{ 0.214694, 0.530433, 0.688190 },
	{ 0.210172, 0.523193, 0.678377 },
	{ 0.205889, 0.515897, 0.668578 },
	{ 0.201771, 0.508598, 0.658787 },
	{ 0.197878, 0.501258, 0.649030 },
	{ 0.194172, 0.493903, 0.639287 },
	{ 0.190556, 0.486541, 0.629572 },
	{ 0.187112, 0.479181, 0.619898 },
	{ 0.183752, 0.471826, 0.610241 },
	{ 0.180500, 0.464474, 0.600622 },
	{ 0.177365, 0.457117, 0.591037 },
	{ 0.174264, 0.449788, 0.581483 },
	{ 0.171224, 0.442474, 0.571966 },
	{ 0.168242, 0.435172, 0.562486 },
	{ 0.165292, 0.427884, 0.553021 },
	{ 0.162439, 0.420608, 0.543603 },
	{ 0.159545, 0.413370, 0.534210 },
	{ 0.156739, 0.406147, 0.524856 },
	{ 0.153905, 0.398932, 0.515524 },
	{ 0.151122, 0.391757, 0.506230 },
	{ 0.148346, 0.384591, 0.496972 },
	{ 0.145641, 0.377462, 0.487751 },
	{ 0.142879, 0.370343, 0.478544 },
	{ 0.140138, 0.363257, 0.469389 },
	{ 0.137466, 0.356204, 0.460239 },
	{ 0.134777, 0.349162, 0.451147 },
	{ 0.132079, 0.342150, 0.442085 },
	{ 0.129401, 0.335173, 0.433042 },
	{ 0.126735, 0.328195, 0.424036 },
	{ 0.124090, 0.321259, 0.415071 },
	{ 0.121456, 0.314347, 0.406144 },
	{ 0.118899, 0.307460, 0.397234 },
	{ 0.116316, 0.300608, 0.388376 },
	{ 0.113731, 0.293781, 0.379546 },
	{ 0.111187, 0.286980, 0.370748 },
	{ 0.108613, 0.280217, 0.362004 },
	{ 0.106159, 0.273497, 0.353280 },
	{ 0.103670, 0.266776, 0.344594 },
	{ 0.101183, 0.260108, 0.335952 },
	{ 0.098776, 0.253467, 0.327342 },
	{ 0.096347, 0.246850, 0.318783 },
	{ 0.094059, 0.240264, 0.310267 },
	{ 0.091788, 0.233727, 0.301758 },
	{ 0.089506, 0.227245, 0.293318 },
	{ 0.087341, 0.220800, 0.284914 },
	{ 0.085142, 0.214360, 0.276576 },
	{ 0.083069, 0.207981, 0.268249 },
	{ 0.081098, 0.201631, 0.259992 },
	{ 0.079130, 0.195361, 0.251781 },
	{ 0.077286, 0.189136, 0.243589 },
	{ 0.075571, 0.182943, 0.235502 },
	{ 0.073993, 0.176835, 0.227434 },
	{ 0.072410, 0.170785, 0.219433 },
	{ 0.071045, 0.164795, 0.211500 },
	{ 0.069767, 0.158901, 0.203628 },
	{ 0.068618, 0.153040, 0.195818 },
	{ 0.067560, 0.147319, 0.188124 },
	{ 0.066665, 0.141671, 0.180452 },
	{ 0.065923, 0.136076, 0.172917 },
	{ 0.065339, 0.130695, 0.165458 },
	{ 0.064911, 0.125349, 0.158169 },
	{ 0.064636, 0.120132, 0.150946 },
	{ 0.064517, 0.115070, 0.143889 },
	{ 0.064554, 0.110222, 0.136957 },
	{ 0.064749, 0.105427, 0.130230 },
	{ 0.065100, 0.100849, 0.123569 },
	{ 0.065383, 0.096469, 0.117170 },
	{ 0.065574, 0.092338, 0.111008 },
	{ 0.065892, 0.088201, 0.104982 },
	{ 0.066388, 0.084134, 0.099288 },
	{ 0.067108, 0.080051, 0.093829 },
	{ 0.068193, 0.076099, 0.088470 },
	{ 0.069720, 0.072283, 0.083025 },
	{ 0.071639, 0.068654, 0.077544 },
	{ 0.073978, 0.065058, 0.072110 },
	{ 0.076596, 0.061657, 0.066651 },
	{ 0.079637, 0.058550, 0.061133 },
	{ 0.082963, 0.055666, 0.055745 },
	{ 0.086537, 0.052997, 0.050336 },
	{ 0.090315, 0.050699, 0.045040 },
	{ 0.094260, 0.048753, 0.039773 },
	{ 0.098319, 0.047041, 0.034683 },
	{ 0.102458, 0.045624, 0.030074 },
	{ 0.106732, 0.044705, 0.026012 },
	{ 0.110986, 0.043972, 0.022379 },
	{ 0.115245, 0.043596, 0.019150 },
	{ 0.119547, 0.043567, 0.016299 },
	{ 0.123812, 0.043861, 0.013797 },
	{ 0.128105, 0.044459, 0.011588 },
	{ 0.132315, 0.045229, 0.009531 },
	{ 0.136451, 0.046164, 0.007895 },
	{ 0.140635, 0.047374, 0.006502 },
	{ 0.144884, 0.048634, 0.005327 },
	{ 0.149230, 0.049836, 0.004346 },
	{ 0.153685, 0.050997, 0.003537 },
	{ 0.158309, 0.052130, 0.002882 },
	{ 0.163014, 0.053218, 0.002363 },
	{ 0.167811, 0.054240, 0.001963 },
	{ 0.172736, 0.055172, 0.001669 },
	{ 0.177801, 0.056018, 0.001469 },
	{ 0.182863, 0.056820, 0.001340 },
	{ 0.188058, 0.057574, 0.001262 },
	{ 0.193233, 0.058514, 0.001226 },
	{ 0.198463, 0.059550, 0.001227 },
	{ 0.203778, 0.060501, 0.001260 },
	{ 0.209092, 0.061486, 0.001322 },
	{ 0.214470, 0.062710, 0.001412 },
	{ 0.219897, 0.063823, 0.001529 },
	{ 0.225345, 0.065027, 0.001675 },
	{ 0.230856, 0.066297, 0.001853 },
	{ 0.236422, 0.067645, 0.002068 },
	{ 0.242016, 0.069092, 0.002325 },
	{ 0.247681, 0.070458, 0.002632 },
	{ 0.253390, 0.071986, 0.002998 },
	{ 0.259176, 0.073640, 0.003435 },
	{ 0.264997, 0.075237, 0.003955 },
	{ 0.270934, 0.076965, 0.004571 },
	{ 0.276928, 0.078822, 0.005301 },
	{ 0.283017, 0.080819, 0.006161 },
	{ 0.289196, 0.082879, 0.007171 },
	{ 0.295466, 0.085075, 0.008349 },
	{ 0.301858, 0.087460, 0.009726 },
	{ 0.308387, 0.089912, 0.011455 },
	{ 0.315024, 0.092530, 0.013324 },
	{ 0.321806, 0.095392, 0.015413 },
	{ 0.328738, 0.098396, 0.017780 },
	{ 0.335805, 0.101580, 0.020449 },
	{ 0.343036, 0.104977, 0.023440 },
	{ 0.350413, 0.108640, 0.026771 },
	{ 0.357947, 0.112564, 0.030456 },
	{ 0.365629, 0.116658, 0.034571 },
	{ 0.373470, 0.120971, 0.039115 },
	{ 0.381463, 0.125606, 0.043693 },
	{ 0.389583, 0.130457, 0.048471 },
	{ 0.397845, 0.135474, 0.053136 },
	{ 0.406220, 0.140795, 0.057848 },
	{ 0.414690, 0.146274, 0.062715 },
	{ 0.423229, 0.151979, 0.067685 },
	{ 0.431837, 0.157906, 0.073044 },
	{ 0.440444, 0.164028, 0.078620 },
	{ 0.449085, 0.170269, 0.084644 },
	{ 0.457704, 0.176666, 0.090869 },
	{ 0.466314, 0.183213, 0.097335 },
	{ 0.474900, 0.189888, 0.104064 },
	{ 0.483420, 0.196677, 0.111039 },
	{ 0.491910, 0.203516, 0.118190 },
	{ 0.500322, 0.210433, 0.125501 },
	{ 0.508690, 0.217425, 0.132983 },
	{ 0.516977, 0.224432, 0.140623 },
	{ 0.525197, 0.231543, 0.148349 },
	{ 0.533349, 0.238624, 0.156261 },
	{ 0.541440, 0.245755, 0.164233 },
	{ 0.549481, 0.252923, 0.172265 },
	{ 0.557462, 0.260091, 0.180403 },
	{ 0.565378, 0.267255, 0.188640 },
	{ 0.573272, 0.274461, 0.196924 },
	{ 0.581112, 0.281673, 0.205237 },
	{ 0.588920, 0.288894, 0.213625 },
	{ 0.596716, 0.296114, 0.222054 },
	{ 0.604484, 0.303345, 0.230529 },
	{ 0.612228, 0.310617, 0.239052 },
	{ 0.619976, 0.317867, 0.247618 },
	{ 0.627708, 0.325132, 0.256189 },
	{ 0.635438, 0.332443, 0.264815 },
	{ 0.643173, 0.339745, 0.273490 },
	{ 0.650917, 0.347064, 0.282179 },
	{ 0.658661, 0.354395, 0.290887 },
	{ 0.666419, 0.361751, 0.299640 },
	{ 0.674194, 0.369121, 0.308415 },
	{ 0.681975, 0.376518, 0.317219 },
	{ 0.689783, 0.383920, 0.326043 },
	{ 0.697596, 0.391354, 0.334929 },
	{ 0.705434, 0.398794, 0.343796 },
	{ 0.713288, 0.406271, 0.352720 },
	{ 0.721158, 0.413757, 0.361662 },
	{ 0.729054, 0.421259, 0.370618 },
	{ 0.736968, 0.428796, 0.379616 },
	{ 0.744900, 0.436349, 0.388639 },
	{ 0.752851, 0.443923, 0.397680 },
	{ 0.760831, 0.451512, 0.406747 },
	{ 0.768821, 0.459124, 0.415838 },
	{ 0.776844, 0.466756, 0.424962 },
	{ 0.784879, 0.474407, 0.434092 },
	{ 0.792935, 0.482080, 0.443269 },
	{ 0.801009, 0.489763, 0.452465 },
	{ 0.809110, 0.497486, 0.461672 },
	{ 0.817222, 0.505207, 0.470910 },
	{ 0.825358, 0.512962, 0.480170 },
	{ 0.833517, 0.520732, 0.489445 },
	{ 0.841692, 0.528527, 0.498763 },
	{ 0.849885, 0.536335, 0.508096 },
	{ 0.858092, 0.544161, 0.517448 },
	{ 0.866324, 0.552013, 0.526825 },
	{ 0.874568, 0.559879, 0.536218 },
	{ 0.882829, 0.567761, 0.545643 },
	{ 0.891110, 0.575670, 0.555082 },
	{ 0.899407, 0.583585, 0.564550 },
	{ 0.907716, 0.591530, 0.574038 },
	{ 0.916031, 0.599492, 0.583552 },
	{ 0.924368, 0.607473, 0.593095 },
	{ 0.932714, 0.615460, 0.602649 },
	{ 0.941076, 0.623483, 0.612229 },
	{ 0.949447, 0.631512, 0.621832 },
	{ 0.957832, 0.639563, 0.631467 },
	{ 0.966219, 0.647628, 0.641113 },
	{ 0.974619, 0.655718, 0.650792 },
	{ 0.983030, 0.663823, 0.660487 },
	{ 0.991448, 0.671939, 0.670216 },
	{ 0.999873, 0.680072, 0.679950 }
};

inline uint32_t color_gradient_viridis(float percent) {
	auto r = int32_t(viridis[uint8_t(percent * 255)][0] * 255);
	auto g = int32_t(viridis[uint8_t(percent * 255)][1] * 255);
	auto b = int32_t(viridis[uint8_t(percent * 255)][2] * 255);
	return sys::pack_color(r, g, b);
}

inline uint32_t color_gradient_magma(float percent) {
	auto r = int32_t(magma[uint8_t(percent * 255)][0] * 255);
	auto g = int32_t(magma[uint8_t(percent * 255)][1] * 255);
	auto b = int32_t(magma[uint8_t(percent * 255)][2] * 255);
	return sys::pack_color(r, g, b);
}

inline uint32_t color_gradient_diverging_berlin(float value) {
	auto r = int32_t(berlin[uint8_t((value + 1.f) / 2.f * 255)][0] * 255);
	auto g = int32_t(berlin[uint8_t((value + 1.f) / 2.f * 255)][1] * 255);
	auto b = int32_t(berlin[uint8_t((value + 1.f) / 2.f * 255)][2] * 255);
	return sys::pack_color(r, g, b);
}

inline uint32_t color_gradient(float percent, uint32_t top_color, uint32_t bot_color) {
	uint32_t color = 0;
	for(uint32_t i = 0; i <= 16; i += 8) {
		auto diff = int32_t(top_color >> i & 0xFF) - int32_t(bot_color >> i & 0xFF);
		color |= uint32_t(int32_t(bot_color >> i & 0xFF) + diff * percent) << i;
	}
	return color;
}

template<class T>
inline uint32_t get_ui_color(sys::state& state, T id) {
	return dcon::fatten(state.world, id).get_color();
}
template<>
inline uint32_t get_ui_color(sys::state& state, dcon::political_party_id id) {
	return dcon::fatten(state.world, id).get_ideology().get_color();
}
template<>
inline uint32_t get_ui_color(sys::state& state, dcon::issue_option_id id) {
	return ogl::color_from_hash(uint32_t(id.index()));
}
template<>
inline uint32_t get_ui_color(sys::state& state, dcon::crime_id id) {
	return ogl::color_from_hash(uint32_t(id.index()));
}

} // namespace ogl
